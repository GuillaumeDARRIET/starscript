/**
* StarLib 1.0.5
* author DARRIET GUILLAUME
* https://lebonnumero.fr/
*
*/
Star.Package("Star",Star.Interface("StarEventDispatcher",{on:function(t,e,a){return this.__eventDispatcherInit(t),this.__eventDispatcherHandlers[t].push(e),this.__eventDispatcherParams[t].push(a),this},off:function(t,e){if(this.__eventDispatcherInit(t),t)if(e){var a=this.__eventDispatcherHandlers[t].indexOf(e);-1!==a&&(this.__eventDispatcherHandlers[t].splice(a,1),this.__eventDispatcherParams[t].splice(a,1))}else delete this.__eventDispatcherHandlers[t],delete this.__eventDispatcherParams[t];else this.__eventDispatcherHandlers={},this.__eventDispatcherParams={};return this},trigger:function(t,e){this.__eventDispatcherInit(t),e||(e={}),e.eventName=t,e.dispatcher=this,this.__eventDispatcherInit(t);for(var a=this.__eventDispatcherHandlers[t].length,i=0;i<a;i++)this.__eventDispatcherHandlers[t][i].apply(null,[e,this.__eventDispatcherParams[t][i]]);return this},__eventDispatcherInit:function(t){t&&(this.__eventDispatcherHandlers||(this.__eventDispatcherHandlers={},this.__eventDispatcherParams={}),this.__eventDispatcherHandlers[t]||(this.__eventDispatcherHandlers[t]=[],this.__eventDispatcherParams[t]=[]))}})),Star.Package("Star",Star.Interface("StarTemplate",{template:function(t,e,a){var i={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};a&&(i.evaluate=a.evaluate||i.evaluate,i.interpolate=a.interpolate||i.interpolate,i.escape=a.escape||i.escape);var s=RegExp([i.escape.source,i.interpolate.source,i.evaluate.source].join("|")+"|$","g"),r=0,n="__p+='",h={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},l=/\\|'|\r|\n|\u2028|\u2029/g,o=function(t){return"\\"+h[t]};t.replace(s,function(e,a,i,s,h){if(n+=t.slice(r,h).replace(l,o),r=h+e.length,i||a){var c=i||a;n+="';\n",n+="try{__t="+c+"+'';}catch(e){__t='##"+c+"##';}\n",n+=a?"__p+=noHtml(__t); \n":"__p+=__t; \n",n+="__p+='"}else s&&(n+="';\n"+s+"\n__p+='");return e}),n="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nnoHtml=function(s){return s.replace(/<\\/?[^>]+(>|$)/g, ''); };\n"+(n="with(obj||{}){\n"+(n+="';\n")+"}\n")+"return __p;\n";try{var c=new Function("obj",n)}catch(t){throw t.source=n,t}var u=function(t){return c.call(this,t)};return u.source="function(obj){\n"+n+"}",u(e)}})),Star.Package("Star",Star.Class("StarRouter",[null,Star.StarEventDispatcher],{pathname:"",baseURI:"/",uri:"",autorizedLangs:[],alias:{},lang:"",params:[],route:"",routeAlias:"",paramsAlias:[],construct:function(t){if(t=!1!==t,null!==Star.StarRouter.Static.instance)throw"ConflictSingleton: Star Router must be unique";var e=document.getElementsByTagName("base");if(e.length<1)throw'MissingBase: Add a base tag in head of document with relative path in href attribute, like <base href="/relative/path/"> or <base href="/">';if(this.baseURI=e[0].getAttribute("href"),"http"===this.baseURI.substr(0,4))throw"BaseHrefError: use relative path in base tag";if("/"!==this.baseURI.substr(0,1)||"/"!==this.baseURI.substr(this.baseURI.length-1,1))throw"BaseHrefError: base href must start and finish by / ";t&&this.__parsePathname(window.location.pathname,!0,!0),window.addEventListener("popstate",this.__onPopState)},__onPopState:function(t){this.__parsePathname(window.location.pathname,!0),this.trigger("change")},__onClickHyperlink:function(t){t.preventDefault();var e=t.currentTarget.getAttribute("href");e&&this.setURI(e)},__parsePathname:function(t,e,a){this.route="",this.params=[];var i=t;e&&(i=t.substring(this.baseURI.length)),this.uri=i;var s=i.split("/");if(""!==this.lang){if(s.length>0&&s[0]!==this.lang&&-1!==this.autorizedLangs.indexOf(s[0])){if(!a)return void(window.location.href=this.baseURI+i);this.lang=s[0]}s.length>0&&s[0]===this.lang&&(s=s.slice(1))}this.route="",s.length>0&&(this.route=s[0]),s.length>1&&(this.params=s.slice(1)),1===this.params.length&&""===this.params[0]&&(this.params=[]),this._detectAlias(),this.uri=(""===this.lang?"":this.lang+"/")+this.routeAlias+(this.paramsAlias.length>0?"/"+this.paramsAlias.join("/"):""),this.pathname=this.baseURI+this.uri},_detectAlias:function(){var t=this.params.length>0?this.route+"/"+this.params.join("/"):this.route,e="";this.routeAlias=this.route,this.paramsAlias=this.params;for(var a in this.alias)if(e=t.substr(a.length),a+e===t&&(""===e||"/"===e.substr(0,1))){var i=(this.alias[a]+e).split("/");this.route="",this.params=[],i.length>0&&(this.route=i[0]),i.length>1&&(this.params=i.slice(1)),1===this.params.length&&""===this.params[0]&&(this.params=[]),this.routeAlias=a,this.paramsAlias=e.substr(1).split("/");break}},addAlias:function(t,e){if("string"==typeof t&&"string"==typeof e)this.alias[t]=e;else if("object"==typeof t)for(var a in t)this.alias[a]=t[a];this._detectAlias()},catchHyperlink:function(t){if(t)for(var e,a=t.getElementsByTagName("a"),i=0;i<a.length;i++)e=a[i].getAttribute("href"),-1===a[i].className.indexOf("StarHyperlink")&&e&&"http"!==e.substr(0,4)&&"mailto"!==e.substr(0,6)&&"tel"!==e.substr(0,3)&&(a[i].className+=" StarHyperlink",a[i].addEventListener("click",this.__onClickHyperlink))},setURI:function(t){this.__parsePathname(t),history.pushState(null,null,this.pathname),this.trigger("change")},getURI:function(){return(""===this.lang?"":this.lang+"/")+this.route+(this.params.length>0?"/"+this.params.join("/"):"")},getLang:function(){return this.lang},getRoute:function(){return this.route},getRouteAlias:function(){return this.routeAlias},getParams:function(){return this.params},localization:function(t,e){return this.autorizedLangs=e,this.lang=t,this.__parsePathname(window.location.pathname,!0,!0),history.replaceState(null,null,this.pathname),this.lang}},{instance:null,getInstance:function(t){return null===Star.StarRouter.Static.instance&&(t=!1!==t,Star.StarRouter.Static.instance=Star.StarRouter(t)),Star.StarRouter.Static.instance}})),Star.Package("Star",Star.Class("StarView",[null,Star.StarEventDispatcher,Star.StarTemplate],{name:"",domID:"",container:null,dataFiles:[],htmlFiles:[],cssFiles:[],data:{},cssID:"",renderClearContainer:!0,router:null,construct:function(){this.router=Star.StarRouter.Static.getInstance(),""!==this.domID&&(this.container=document.getElementById(this.domID))},render:function(){this.removeListeners(),this.extractData(),this.container&&this.renderClearContainer&&(this.container.innerHTML=""),this.appendHTML(),this.appendCSS(),this.router.catchHyperlink(this.container)},extractData:function(){for(var t,e=0;e<this.dataFiles.length;e++){t=JSON.parse(Star.GetFile(this.dataFiles[e]));for(var a in t)this.data[a]=t[a]}},appendCSS:function(){var t;if(""===this.cssID||!(t=document.getElementById(this.cssID))||""===t.innerHTML){for(var e,a="",i=0;i<this.cssFiles.length;i++)e=Star.GetFile(this.cssFiles[i]),a+=e=this.template(e,this.data);var s=document.createElement("style");s.innerHTML=a,t?t.appendChild(s):this.container&&this.container.appendChild(s)}},appendHTML:function(){for(var t,e="",a=0;a<this.htmlFiles.length;a++)t=Star.GetFile(this.htmlFiles[a]),e+=t=this.template(t,this.data);this.container&&(this.container.innerHTML+=e)},removeListeners:function(){this.off()},destruct:function(){this.removeListeners(),this.remove()}})),Star.Localization=function(t,e){return Star.StarRouter.Static.getInstance(!1).localization(t,e)};